process.name: (*powershell.exe OR *pwsh.exe) AND process.parent.executable: (*powershell.exe OR *pwsh.exe)file.path: *.docm OR *.dotm OR *.xlsm OR *.xltm OR *.potm OR *.pptm OR *.pptx

process.name: (*powershell.exe OR *pwsh.exe) AND file.path: *ntds.dit 

file.path: system.management.automation AND NOT process.name: (*powershell.exe OR *pwsh.exe)

process.name: (*powershell.exe OR *pwsh.exe) AND destination.port: "5985"

process.name: (*powershell.exe OR *pwsh.exe) AND NOT destination.ip:"10\..*" OR "192\.168\..*" OR "172\..*" OR '127.0.0.1'

process.name: (*powershell.exe OR *pwsh.exe) AND NOT process.parent.executable: explorer.exe OR compattelrunner.exe

process.name: (*powershell.exe OR *pwsh.exe) AND process.name: "*sqlservr.exe"

process.name: (*powershell.exe OR *pwsh.exe) AND process.name:"*rundll32.exe"

process.name: (*powershell.exe OR *pwsh.exe) AND file.path: *.bat

process.name: (*powershell.exe OR *pwsh.exe) AND file.path: *startup* AND file.path: *.lnk

process.parent.executable: (*powershell.exe OR *pwsh.exe) AND process.name: csi.exe

process.name: (powershell.exe OR pwsh.exe) AND dll.name: "taskschd.dll" OR file.name: "taskschd.dll" AND destination.port:135 AND NOT destination.address:("127.0.0.1" OR "::1")

process.name: (powershell.exe OR pwsh.exe) AND process.parent.name: "hh.exe"

process.name: (powershell.exe OR pwsh.exe) AND process.parent.name: "msbuild.exe"

process.name: (powershell.exe OR pwsh.exe) AND process.parent.name: "rundll32.exe"

process.name: (powershell.exe OR pwsh.exe) AND process.parent.name: "w3wp.exe"

process.name: (powershell.exe OR pwsh.exe) AND process.parent.name: "zoom.exe"

process.name: (powershell.exe OR pwsh.exe) AND process.parent.name: ("configurationwizard*.exe" OR "netflowdatabasemaintenance*.exe" OR "netflowservice*.exe" OR "solarwinds.administration*.exe" OR "solarwinds.collector.service*.exe" OR "solarwindsdiagnostics*.exe")

process.name: (powershell.exe OR pwsh.exe) AND process.parent.name: ("cscript.exe" OR "wscript.exe")

process.name: (powershell.exe OR pwsh.exe) AND process.parent.name: ("w3wp.exe" OR "httpd.exe" OR "nginx.exe" OR "php.exe" OR "php-cgi.exe" OR "tomcat.exe")

process.name: (*powershell.exe OR *pwsh.exe) AND file.path:(*c\\:userspublic* OR *c\\:perflogs* OR *appdata* OR *c\\:windowstemp*)

process.name: (*powershell.exe OR *pwsh.exe) AND file.path:*ntds.dit

process.name: (*powershell.exe OR *pwsh.exe) AND process.parent.command_line:*msiexec.exe* AND process.parent.command_line:*\\-embedding\\*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.parent.name: (*eqnedt32.exe OR *excel.exe OR *httpd.exe OR *java.exe OR *keytool.exe OR *mmc.exe OR *msaccess.exe OR *mshta.exe OR *mspub.exe OR *nginx.exe OR *outlook.exe OR *php\\-cgi.exe OR *powerpnt.exe OR *scrcons.exe OR *sdiagnhost.exe OR *serv\\-u.exe OR *sqlservr.exe OR *tomcat.exe OR *umworkerprocess.exe OR *visio.exe OR *vmtoolsd.exe OR *w3wp.exe OR *windowshh.exe OR *windowsinstaller* OR *winword.exe OR *wmiprvse.exe OR *ws_tomcatservice.exe OR *wsmprovhost.exe)

process.parent.executable: (*powershell.exe OR *pwsh.exe) AND process.name: sh.exe OR bash.exe OR schtasks.exe OR certutil.exe OR bitsadmin.exe OR wscript.exe OR cscript.exe OR scrcons.exe OR regsvr32.exe OR hh.exe OR wmic.exe OR mshta.exe OR rundll32.exe OR forfiles.exe OR scriptrunner.exe

process.parent.name:(*powershell.exe OR *pwsh.exe) AND (process.name:*msdt.exe) OR process.name:(*csi.exe) OR process.name:(*mofcomp.exe)

process.parent.name:(*powershell.exe OR *pwsh.exe) AND file.path:(*.docm OR *.dotm OR *.xlsm OR *.xltm OR *.potm OR *.pptm OR *.pptx)

process.parent.name:(*powershell.exe OR *pwsh.exe) AND file.path:*ntds.dit

process.parent.name:(*powershell.exe OR *pwsh.exe) AND process.name:(*nslookup.exe OR *certutil.exe OR *bitsadmin.exe OR *mshta.exe)) AND NOT (process.working_directory:*ccmcache*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.parent.executable: *wlsvcx64.exe 

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line:"*-version 2" OR "*-versio 2" OR "*-versi 2" OR "-vers 2" OR "-ver 2" OR "-ve 2"

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: (*clear-eventlog OR *remove-eventlog OR *limit-eventlog)

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line:*wind* OR "*win h*" OR "*wi h*" OR "-nop*" OR "-noni*" OR "-e*" OR "*exec*" OR "*bypass* OR "invoke-expression" OR "iex" OR "*download*

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: "*downloadfile*" OR process.command_line: "*invoke-webrequest*" OR process.command_line: "*http*" OR process.command_line: "*invoke-shellcode*" OR process.command_line: "*downloadstring*"

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: "get-childitem -recurse -include .*\.ppt" OR process.command_line: "get-childitem -recurse -include .*\.doc" OR process.command_line: "get-childitem -recurse -include .*\.xls" OR process.command_line: "get-childitem -recurse -include .*\.pptx" OR process.command_line: "get-childitem -recurse -include .*\.docx" OR process.command_line: "get-childitem -recurse -include .*\.xlsx" OR process.command_line: "get-childitem -recurse -include .*\.pdf" OR process.command_line: "get-childitem -recurse -include .*\.csv" OR process.command_line: "get-childitem -recurse -include .*\.mdb" OR process.command_line: "get-childitem -recurse -include .*\.pps"

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: "wmic os list full" OR process.command_line: "wmic computersystem list full" OR process.command_line: "wmic path win32_pnpdevice" OR process.command_line: "wmic qfe list brief"

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: new-service

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: *shadow* AND *create*

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: add-pssnapin microsoft.exchange.powershell.snapin*

process.name: (powershell.exe OR pwsh.exe) AND process.command_line: "*set-netfirewallprofile*" AND (process.command_line: "*-enabled*" AND process.command_line: "*false*") AND (process.command_line: "*-all*" OR process.command_line: ("*public*" OR "*domain*" OR "*private*"))

process.name: (powershell.exe OR pwsh.exe) AND process.command_line: "echo" AND process.command_line: ">" AND process.command_line: "*\\pipe\\*"

process.name: (powershell.exe OR pwsh.exe) AND process.command_line: "set-casmailbox*activesyncalloweddeviceids*"

process.name: (powershell.exe OR pwsh.exe) AND process.command_line: ("*add-mppreference*" OR "*set-mppreference*") AND process.command_line: ("-disable*" OR "disabled" OR "neversend" OR "*-exclusion*")

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: ("try" AND "add-mppreference" AND "-exclusionpath" AND "programdata" AND "catch")

process.name: (powershell.exe OR pwsh.exe) AND process.command_line: ("*get-wmiobject*" OR "*gwmi*" OR "*get-ciminstance*" OR "*gcim*") AND process.command_line: ("*win32_shadowcopy*") AND process.command_line: ("*.delete()*" OR "*remove-wmiobject*" OR "*rwmi*" OR "*remove-ciminstance*" OR "*rcim*")

process.name: (powershell.exe OR pwsh.exe) AND process.command_line: ("*mailboxexportrequest*" OR "*-mailbox*-contentfilter*")

process.name: (powershell.exe OR pwsh.exe) AND process.command_line: ("*mklink*" OR "*symboliclink*") AND process.command_line: ("*harddiskvolumeshadowcopy*")

process.name: (*powershell.exe OR *pwsh.exe) AND (process.command_line:(*toint* OR *todecimal* OR *tobyte* OR *touint* OR *tosingle* OR *tosbyte*) AND process.command_line:(*tochar* OR *tostring* OR *string*)) OR (process.command_line:*join* AND (process.command_line:*char* OR process.command_line:*split*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line:(*\\-disablebehaviormonitoring\\$true* OR *\\-disableruntimemonitoring\\$true*)) OR (process.command_line:*sc* AND process.command_line:*stop* AND process.command_line:*windefend*) OR (process.command_line:*sc* AND process.command_line:*config* AND process.command_line:*windefend* AND process.command_line:*start\\=disabled*))

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line:(*userspublic* OR *file*public*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line:(*windowstemp* OR *temporary\\internet* OR *appdatalocaltemp* OR *appdataroamingtemp* OR *%temp%* OR *%tmp%* OR *%localappdata%temp*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line:(*windowsty* OR *windowsh* OR *windoh* OR *windh* OR *winh* OR *wih* OR *winh* OR *nopr* OR *nonin* OR *ec* OR *en* OR *exec OR *exeby*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line:*foreach* AND process.command_line:*xor*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line:*get\\-content* AND process.command_line:*\\-stream*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line:*new\\-object* AND process.command_line:*\\.net\\.*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line:*pester* AND process.command_line:*get\\-help*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line:*start\\- \bitstransfer*

process.name: (*powershell.exe OR *pwsh.exe) AND process.parent.name:*excel.exe AND process.command_line:*dataexchange.dll*)

process.parent.executable: (*powershell.exe OR *pwsh.exe) AND process.name: nslookup.exe AND process.command_line: nslookup.exe

process.parent.name:(*powershell.exe OR *pwsh.exe) AND process.command_line:(*\\pass\\* OR *\\user\\* OR *\\copy\\* OR *\\mega\\* OR *\\sync\\* OR *\\config\\* OR *\\lsd\\* OR *\\remote\\* OR *\\ls\\*)

process.parent.name:(*powershell.exe OR *pwsh.exe) AND process.name:*chrome.exe AND process.command_line:(*\\-\\-load\\-extension\\=*) AND process.command_line:(*appdatalocal*)

process.parent.name:(*powershell.exe OR *pwsh.exe) AND process.name:*schtasks.exe AND process.command_line:*\\/create* AND process.command_line:*\\/sc* AND process.command_line:*\\/tn* AND process.command_line:*updater* AND process.command_line:*\\/tr* AND process.command_line:*powershell* AND process.command_line:(*onlogon* OR *daily* OR *onidle* OR *updater*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: "vmblastsg"

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: "siex"

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: ("-met" AND "post" AND "-body")

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: "detectsandboxie"

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: ("*base64*" OR "*gnirts46esabmorf*")

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: "*powercat.ps1"

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: ("-ep bypass" AND "-command" AND "get-content" AND "remove-item" AND "iex")

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: ("iex" AND "text.encoding" AND "utf8.getstring" AND ("unrestricted" OR "hidden")

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: ("$admins=" AND "system.security.principal.securityidentifier" AND "translate" AND "-split" AND "localgroup" "/add" AND "$rdp=")

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: (*mimikatz* OR *-dumpcr* OR *sekurlsa* OR *kerberos*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: (*getprocaddress*)

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line:*system.management.automation.amsi*

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: *get-netdomaintrust* OR *get-netforesttrust* OR *get-addomain* OR *get-adgroupmember* OR *get-domainuser*

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: *threading.mutex*

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: "*io.compression.*" OR "*io.streamreader*" OR "*]::decompress*"

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: (*select* OR *get-wmiobject*) AND *win32*

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: ("add-persistence" OR "find-avsignature" OR "get-gppautologon" OR "get-gpppassword" OR "get-httpstatus" OR "get-keystrokes" OR "get-securitypackages" OR "get-timedscreenshot" OR "get-vaultcredential" OR "get-volumeshadowcopy" OR "install-ssp" OR "invoke-credentialinjection" OR "invoke-dllinjection" OR "invoke-mimikatz" OR "invoke-ninjacopy" OR "invoke-portscan" OR "invoke-reflectivepeinjection" OR "invoke-reversednslookup" OR "invoke-shellcode" OR "invoke-tokenmanipulation" OR "invoke-wmicommand" OR "mount-volumeshadowcopy" OR "new-elevatedpersistenceoption" OR "new-userpersistenceoption" OR "new-volumeshadowcopy" OR "out-compresseddll" OR "out-encodedcommand" OR "out-encryptedscript" OR "out-minidump" OR "powerup" OR "powerview" OR "remove-comments" OR "remove-volumeshadowcopy" OR "set-criticalprocess" OR "set-masterbootrecord")

process.name: (*powershell.exe OR *pwsh.exe) AND process.command_line: "*invoke-globalo365mailsearch*" OR "*invoke-globalmailsearch*" OR "*invoke-selfsearch*" OR "*invoke-passwordsprayowa*" OR "*invoke-passwordsprayews*" OR "*invoke-domainharvestowa*" OR "*invoke-usernameharvestowa*" OR "*invoke-openinboxfinder*" OR "*invoke-injectgeventapi*" OR "*invoke-injectgevent*" OR "*invoke-searchgmail*" OR "*invoke-monitorcredsniper*" OR "*invoke-addgmailrule*" OR "*invoke-passwordsprayeas*" OR "*invoke-usernameharvesteas*"
