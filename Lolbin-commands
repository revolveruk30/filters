WINDOWS_LOLBINS = 

"appinstaller", "appinstaller.exe", "at", "at.exe", "atbroker", "atbroker.exe", "bash", "bash.exe","bitsadmin", "bitsadmin.exe", "certreq", "certreq.exe", "certutil", "certutil.exe", "cmd","cmd.exe", "cmdkey", "cmdkey.exe", "cmstp", "cmstp.exe", "configsecuritypolicy","configsecuritypolicy.exe", "control", "control.exe", "csc", "csc.exe", "cscript", "cscript.exe","datasvcutil", "datasvcutil.exe", "desktopimgdownldr", "desktopimgdownldr.exe", "dfsvc","dfsvc.exe", "diantz", "diantz.exe", "diskshadow", "diskshadow.exe", "dllhost", "dllhost.exe","dnscmd", "dnscmd.exe", "esentutl", "esentutl.exe", "eventvwr", "eventvwr.exe", "expand","expand.exe", "explorer", "explorer.exe", "extexport", "extexport.exe", "extrac32", "extrac32.exe","findstr", "findstr.exe", "forfiles", "forfiles.exe", "ftp", "ftp.exe", "gfxdownloadwrapper","gfxdownloadwrapper.exe", "gpscript", "gpscript.exe", "hh", "hh.exe", "ie4uinit", "ie4uinit.exe","ieexec", "ieexec.exe", "ilasm", "ilasm.exe", "infdefaultinstall", "infdefaultinstall.exe","installutil", "installutil.exe", "jsc", "jsc.exe", "makecab", "makecab.exe", "mavinject","mavinject.exe", "microsoft", "microsoft.exe", "mmc", "mmc.exe", "mpcmdrun", "mpcmdrun.exe","msbuild", "msbuild.exe", "msconfig", "msconfig.exe", "msdt", "msdt.exe", "mshta", "mshta.exe","msiexec", "msiexec.exe", "netsh", "netsh.exe", "odbcconf", "odbcconf.exe", "pcalua", "pcalua.exe","pcwrun", "pcwrun.exe", "pktmon", "pktmon.exe", "pnputil", "pnputil.exe", "presentationhost","presentationhost.exe", "print", "print.exe", "psr", "psr.exe", "rasautou", "rasautou.exe", "reg","reg.exe", "regasm", "regasm.exe", "regedit", "regedit.exe", "regini", "regini.exe","register-cimprovider", "register-cimprovider.exe", "regsvcs", "regsvcs.exe", "regsvr32","regsvr32.exe", "replace", "replace.exe", "rpcping", "rpcping.exe", "rundll32", "rundll32.exe","runonce", "runonce.exe", "runscripthelper", "runscripthelper.exe", "sc", "sc.exe", "schtasks","schtasks.exe", "scriptrunner", "scriptrunner.exe", "syncappvpublishingserver","syncappvpublishingserver.exe", "ttdinject", "ttdinject.exe", "tttracer", "tttracer.exe", "vbc","vbc.exe", "verclsid", "verclsid.exe", "wab", "wab.exe", "wmic", "wmic.exe", "wscript","wscript.exe", "wsreset", "wsreset.exe", "wuauclt", "wuauclt.exe", "xwizard", "xwizard.exe","advpack", "advpack.exe", "comsvcs", "comsvcs.exe", "ieadvpack", "ieadvpack.exe", "ieaframe","ieaframe.exe", "mshtml", "mshtml.exe", "pcwutl", "pcwutl.exe", "setupapi", "setupapi.exe","shdocvw", "shdocvw.exe", "shell32", "shell32.exe", "syssetup", "syssetup.exe", "url", "url.exe","zipfldr", "zipfldr.exe", "adplus", "adplus.exe", "agentexecutor", "agentexecutor.exe", "appvlp","appvlp.exe", "bginfo", "bginfo.exe", "cdb", "cdb.exe", "coregen", "coregen.exe", "csi", "csi.exe","defaultpack", "defaultpack.exe", "devtoolslauncher", "devtoolslauncher.exe", "dnx", "dnx.exe","dotnet", "dotnet.exe", "dxcap", "dxcap.exe", "excel", "excel.exe", "mftrace", "mftrace.exe","msdeploy", "msdeploy.exe", "msxsl", "msxsl.exe", "ntdsutil", "ntdsutil.exe", "powerpnt","powerpnt.exe", "rcsi", "rcsi.exe", "remote", "remote.exe", "sqldumper", "sqldumper.exe", "sqlps","sqlps.exe", "sqltoolsps", "sqltoolsps.exe", "squirrel", "squirrel.exe", "te", "te.exe", "tracker","tracker.exe", "update", "update.exe", "vsjitdebugger", "vsjitdebugger.exe", "winword","winword.exe", "wsl", "wsl.exe", "cl_mutexverifiers", "cl_mutexverifiers.exe", "cl_invocation","cl_invocation.exe", "manage-bde", "manage-bde.exe", "pubprn", "pubprn.exe", "slmgr", "slmgr.exe","winrm", "winrm.exe", "pester", "pester.exe", "ms-appinstaller", "ms-appinstaller.exe","powershell", "powershell.exe", "copy", "copy.exe", "echo", "echo.exe","microsoft.workflow.compiler", "microsoft.workflow.compiler.exe", "python", "python.exe", "psexec","psexec.exe", "SharpHound", "SharpHound.exe", "shadowcopy", "shadowcopy.exe", "vssadmin","vssadmin.exe", "rubeus", "rubeus.exe", "juicypotato", "juicypotato.exe", "roguepotato","roguepotato.exe", "watson", "watson.exe", "sharpgpoabuse", "sharpgpoabuse.exe", "ms-rprn","ms-rprn.exe", "telnet", "telnet.exe", "nc", "nc.exe", "git", "git.exe", "net", "net.exe","wusa", "wusa.exe", "wevtutil", "wevtutil.exe", "nltest", "nltest.exe", "systeminfo", "systeminfo.exe","chcp", "chcp.exe", "tasklist", "tasklist.exe", "qwinsta", "qwinsta.exe","gsecdump", "gsecdump.exe", "wce", "wce.exe", "sdelete", "sdelete.exe", "gpresult", "gpresult.exe","ver", "ver.exe",'wc'

WINDOWS_PATHS =

'C:\Windows\Microsoft.NET\Framework64'
'C:\Windows\Temp'
'C:\Windows\System32'
'C:\Windows\SysWOW64'
'C:\Windows\System32\svchost.exe'
'C:\Windows\System32\WScript.exe'
'C:\Windows\System32\cmd.exe'
'C:\Windows\System32\Rundll32.exe'
'C:\Windows\System32\mshta.exe'


WINDOWS_REGEX =

(?P<admin_share>ADMIN\$)
(?P<ATBroker_start>ATBroker.*start)
(?P<bginfo_popup>bginfo.*popup)
(?P<bitsadmin_addfile>bitsadmin.*addfile)
(?P<bitsadmin_create>bitsadmin.*create)
(?P<bitsadmin_download_ttp>bitsadmin.*download.*http)
(?P<bitsadmin_transfer_ttp>bitsadmin.*transfer.*http)
(?P<bitsDownloader_http>call.*bitsDownloader.*http)
(?P<bloodhound_invoke>lood.*ound)
(?P<bloodhound_password>lood.*ound.*assword)
(?P<bloodhound_username>lood.*ound.*sername)
(?P<C_share>C\$)
(?P<cab_file>\.cab)
(?P<call_bat_script_hppr>call.*bat.*http)
(?P<CertReq_config_post>ert.*eq.*\-.*ost.*\-config)
(?P<certutil_decode>certutil.*decode)
(?P<certutil_download_decode>certutil.*urlcache.*http.*decode)
(?P<certutil_downloader_execute>certutil.*urlcache.*http.*InstallUtil)
(?P<certutil_downloader>certutil.*urlcache.*http)
(?P<certutil_encode>certutil.*encode)
(?P<chcp>chcp)
(?P<chisel_client>chisel.*client)
(?P<cmd_k>cmd.*\/k)
(?P<cmstp_http>cmstp.*http)
(?P<ConfigSecurityPolicy_http>onfig.*ecurity.*olicy.*http)
(?P<cs_file>\.cs)
(?P<cscript_jscript>cscript.*jscript)
(?P<DataSvcUtil_http>DataSvcUtil.*\/uri)
(?P<desktopimgdownldr_conn>desktopimgdownldr.*http)
(?P<diantz_remote>diantz.*\\\\)
(?P<dir_a>dir\s.*\/a)
(?P<dir_b>dir\s.*\/b)
(?P<dir_s>dir\s.*\/s)
(?P<diskshadow_list>diskshadow.*list)
(?P<dll>\.dll$)
(?P<dnscmd_config>dnscmd.*config)
(?P<dnscmd_remote>dnscmd.*\\\\)
(?P<DomainSPNTicket>DomainSPNTicket)
(?P<dot_url>\.url)
(?P<dxcap_c>xcap.*\-c)
(?P<esentutl_y>esentutl.*\/y)
(?P<excel_http>xcel.*http)
(?P<exec_bypass>exec\s+bypass)
(?P<explorer_root>explorer.*\/root)
(?P<findstr_I>findstr.*\/I)
(?P<findstr_L>findstr.*\/L)
(?P<findstr_S>findstr.*\/S)
(?P<findstr_V>findstr.*\/V)
(?P<get_netuser_spn>Get-NetUser.*[\-\w]{3,10})
(?P<gpresult_r>gpresult.*\/r)
(?P<gpresult_s>gpresult.*\/s)
(?P<gpresult>gpresult)
(?P<gsecdump_a>gsecdump.*\-a)
(?P<gsecdump>gsecdump)
(?P<hh_http>HH.*http)
(?P<hta>\.hta)
(?P<ieexec_http>ieexec.*http)
(?P<ilasm_exe>ilasm.*\/exe)
(?P<inf_file>\.inf)
(?P<invoke_command_credential>nvoke.*ommand.*dential)
(?P<ipc_share>IPC\$)
(?P<ipconfig_all>ipconfig.*all)
(?P<ipconfig_displaydns>ipconfig.*\/displaydns)
(?P<ipconfig>ipconfig)
(?P<js_file>\.js)
(?P<juicy_potato>uicy.*otato.*\-t\s+\*\s+\-p)
(?P<kerberoasting>erberoast)
(?P<kerberos_golden>kerberos.*golden)
(?P<kerberos_krbtgt>kerberos.*krbtgt)
(?P<kerberos_rc4>kerberos.*rc4)
(?P<KerberosRequestorSecurityToken>KerberosRequestorSecurityToken)
(?P<KEYWORD_add>add\s)
(?P<KEYWORD_advpack_dll>advpack\.dll)
(?P<KEYWORD_asktgt>asktgt)
(?P<KEYWORD_bash>bash)
(?P<KEYWORD_call>call\s)
(?P<KEYWORD_comspec>comspec)
(?P<KEYWORD_config>\/config)
(?P<KEYWORD_Control_RunDLL>Control\_RunDLL)
(?P<KEYWORD_CredentialCache>CredentialCache)
(?P<KEYWORD_cscript>cscript)
(?P<KEYWORD_dash_a>\-a\s)
(?P<KEYWORD_dash_appvscript>\-appvscript)
(?P<KEYWORD_dash_attach>\-attach)
(?P<KEYWORD_dash_c>\-c\s)
(?P<KEYWORD_dash_config>\-config)
(?P<KEYWORD_dash_CreateProcess>\-CreateProcess)
(?P<KEYWORD_dash_decode>\-decode)
(?P<KEYWORD_dash_download>\-download)
(?P<KEYWORD_dash_dumpFull>\-dumpFull)
(?P<KEYWORD_dash_encode>\-encode)
(?P<KEYWORD_dash_f>\-f\s)
(?P<KEYWORD_dash_interactive>\/interactive)
(?P<KEYWORD_dash_noprofile>\-noprofile)
(?P<KEYWORD_dash_out>\-out)
(?P<KEYWORD_dash_path>\-path)
(?P<KEYWORD_dash_rsocket>\-rsocket)
(?P<KEYWORD_dash_update>\-update)
(?P<KEYWORD_dash_uri>\-uri)
(?P<KEYWORD_dash_urlcache>\-urlcache)
(?P<KEYWORD_dir>dir\s)
(?P<KEYWORD_DllMain>DllMain)
(?P<KEYWORD_DownloadFile>DownloadFile)
(?P<KEYWORD_DownloadString>DownloadString)
(?P<KEYWORD_exec>exec\s+)
(?P<KEYWORD_fsutil>fsutil)
(?P<KEYWORD_GetBytes>GetBytes)
(?P<KEYWORD_GetStream>GetStream)
(?P<KEYWORD_helper>helper\s)
(?P<KEYWORD_http>http.{0,1}\:\/\/)
(?P<KEYWORD_Httpclient>Httpclient)
(?P<KEYWORD_ieframe_dll>ieframe.dll)
(?P<KEYWORD_IEX>IEX\s)
(?P<KEYWORD_invoke>invoke)
(?P<KEYWORD_ipconfig>ipconfig)
(?P<KEYWORD_javascript>javascript)
(?P<KEYWORD_JuicyPotato>JuicyPotato)
(?P<KEYWORD_Kerberos>Kerberos)
(?P<KEYWORD_krbtgt>krbtgt)
(?P<KEYWORD_lambda>lambda)
(?P<KEYWORD_LaunchApplication>LaunchApplication)
(?P<KEYWORD_LaunchForDeploy>LaunchForDeploy)
(?P<KEYWORD_lsass_exe>lsass\.exe)
(?P<KEYWORD_lsass>lsass)
(?P<KEYWORD_lusrrngr>lusrrngr)
(?P<KEYWORD_mimikatz>mimikatz)
(?P<KEYWORD_MiniDump>MiniDump)
(?P<KEYWORD_mshta>mshta)
(?P<KEYWORD_Mshtml_dll>Mshtml.dll)
(?P<KEYWORD_myDownloadJob>myDownloadJob)
(?P<KEYWORD_New_Object>New\-Object)
(?P<KEYWORD_ni>\/ni\s)
(?P<KEYWORD_nslookup>nslookup)
(?P<KEYWORD_NTLM>NTLM)
(?P<KEYWORD_OpenURL>OpenURL)
(?P<KEYWORD_pcwutl_dll>pcwutl.dll)
(?P<KEYWORD_powershell_import>powershell\-import)
(?P<KEYWORD_procdump>procdump)
(?P<KEYWORD_process>process)
(?P<KEYWORD_Processid>\/Processid)
(?P<KEYWORD_restart>restart)
(?P<KEYWORD_RoguePotato>RoguePotato)
(?P<KEYWORD_Rubeus>Rubeus)
(?P<KEYWORD_rundll32>rundll32)
(?P<KEYWORD_RunWizard>RunWizard)
(?P<KEYWORD_s>\/s\s+)
(?P<KEYWORD_s2p_thread>s2p\_thread)
(?P<KEYWORD_secpool>secpool)
(?P<KEYWORD_sekurlsa>sekurlsa)
(?P<KEYWORD_services>services)
(?P<KEYWORD_SetupInfObjectInstallAction>SetupInfObjectInstallAction)
(?P<KEYWORD_shadowcopy>shadowcopy)
(?P<KEYWORD_SharpHound>SharpHound)
(?P<KEYWORD_shell>shell)
(?P<KEYWORD_shell32_dll>shell32\.dll)
(?P<KEYWORD_Sherlock>Sherlock)
(?P<KEYWORD_slash_accepteula>\/accepteula)
(?P<KEYWORD_slash_addfile>\/addfile)
(?P<KEYWORD_slash_AlternateShellStartup>\/AlternateShellStartup\s+)
(?P<KEYWORD_slash_create>\/create)
(?P<KEYWORD_slash_d>\/d\s+)
(?P<KEYWORD_slash_delete>\/delete\s+)
(?P<KEYWORD_slash_download>\/download\s+)
(?P<KEYWORD_slash_exe>\/exe\s+)
(?P<KEYWORD_slash_I>\/I\s+)
(?P<KEYWORD_slash_INJECTRUNNING>\/INJECTRUNNING\s+)
(?P<KEYWORD_slash_L>\/L\s+)
(?P<KEYWORD_slash_Launch>\/Launch\s+)
(?P<KEYWORD_slash_lockscreenurl>\/lockscreenurl\s+)
(?P<KEYWORD_slash_logon>\/logon\s+)
(?P<KEYWORD_slash_node>\/node\s+)
(?P<KEYWORD_slash_nolicprompt>\/nolicprompt\s+)
(?P<KEYWORD_slash_nologo>\/\/nologo\s+)
(?P<KEYWORD_slash_output>\/output\s+)
(?P<KEYWORD_slash_p>\/p\s+)
(?P<KEYWORD_slash_password>\/password\s+)
(?P<KEYWORD_slash_popup>\/popup\s+)
(?P<KEYWORD_slash_quiet>\/quiet\s+)
(?P<KEYWORD_slash_root>\/root)
(?P<KEYWORD_slash_RunHandlerComServer>\/RunHandlerComServer\s+)
(?P<KEYWORD_slash_S>\/S\s+)
(?P<KEYWORD_slash_sc>\/sc\s+)
(?P<KEYWORD_slash_skip>\/skip\s+)
(?P<KEYWORD_slash_start>\/start)
(?P<KEYWORD_slash_target>\/target\s+)
(?P<KEYWORD_slash_tn>\/tn\s+)
(?P<KEYWORD_slash_transfer>\/transfer\s+)
(?P<KEYWORD_slash_UpdateDeploymentProvider>\/UpdateDeploymentProvider\s+)
(?P<KEYWORD_slash_user>\/user\s+)
(?P<KEYWORD_slash_V>\/V\s+)
(?P<KEYWORD_socket>socket)
(?P<KEYWORD_surfacecheck>surfacecheck)
(?P<KEYWORD_syssetup_dll>syssetup\.dll)
(?P<KEYWORD_System_Text_Encoding>System\.Text\.Encoding)
(?P<KEYWORD_taskmgr>taskmgr)
(?P<KEYWORD_TCPClient>TCPClient)
(?P<KEYWORD_ToBase64String>ToBase64String)
(?P<KEYWORD_tree>tree\s)
(?P<KEYWORD_URi>\-Uri)
(?P<KEYWORD_url_dll>url\.dll)
(?P<KEYWORD_vssadmin>vssadmin)
(?P<KEYWORD_Watson>Watson)
(?P<KEYWORD_WebClient>WebClient)
(?P<KEYWORD_webclientDownload>webclientDownload)
(?P<KEYWORD_Win32_Process>Win32\_Process)
(?P<KEYWORD_windir>windir)
(?P<KEYWORD_winhhtpjs>winhhtpjs)
(?P<KEYWORD_WinHttp>WinHttp)
(?P<KEYWORD_WinHttpRequest>WinHttpRequest)
(?P<KEYWORD_WriteAllBytes>WriteAllBytes)
(?P<KEYWORD_XMLHTTPDownloadJS>XMLHTTPDownloadJS)
(?P<KEYWORD_y>\/y\s+)
(?P<KEYWORD_zipfldr_dll>RouteTheCall)
(?P<lua_socket>lua.*socket)
(?P<lua_tcp>lua.*tcp)
(?P<makecab_remote>makecab.*\\\\\\\\)
(?P<MavInject_INJECTRUNNING>MavInject.*INJECTRUNNING)
(?P<mimikatz_dump>imikatz.*dump)
(?P<mimikatz_kerberos>imikatz.*kerberos)
(?P<mimikatz_piece>imikatz)
(?P<mimikatz_sekurlsa>imikatz.*sekurlsa)
(?P<mklink_shadowcopy>mklink.*shadowcopy)
(?P<MpCmdRun_DownloadFile>MpCmdRun.*DownloadFile)
(?P<MpCmdRun_http>MpCmdRun.*http)
(?P<ms_appinstaller_http>start.*appinstaller.*http)
(?P<MS_RPRN_invoke>RPRN)
(?P<msbuild_remote_lc>msbuild.*\\\\)
(?P<msbuild_remote>MSBuild.*\\\\)
(?P<MSbuld_get_execute_lc>msbuil.*\!mb.*autoresponse)
(?P<MSbuld_get_execute>MSBuil.*\!MB.*autoresponse)
(?P<mshta_hta_script>mshta.*\.hta)
(?P<mshta_http>mshta.*http)
(?P<mshta_vbscript>mshta.*vbscript)
(?P<nc_listener_extra>nc\s+\-l.*\-[npv]+)
(?P<nc_listener_to_shell>nc.*[\-lnpv]+.*\-e.*sh)
(?P<nc_listener>nc.*\-l[npv]+)
(?P<nc_reverse_shell>nc.*\-e.*cmd)
(?P<net_accounts>net\s.*accounts)
(?P<net_add>net\s.*\/add)
(?P<net_all>net\s.*\/all)
(?P<net_computer>net\s.*computer)
(?P<net_del>net\s.*\/del)
(?P<net_domain>net\s.*\/domain)
(?P<net_dot_exe>net\.exe)
(?P<net_group>net*\sgroup)
(?P<net_localgroup>net\s.*localgroup)
(?P<net_share>net\s.*share)
(?P<net_use>net\s.*use\s)
(?P<net_user>net\s.*user)
(?P<net_view>net\s.*view)
(?P<netsh_add_helper>netsh.*add.*helper)
(?P<netsh_advfirewall>netsh.*advfirewall)
(?P<netsh_firewall>netsh.*firewall)
(?P<netsh_interface>netsh.*interface)
(?P<netsh_portproxy>netsh.*portproxy)
(?P<netsh_v4tov4>netsh.*v4tov4)"
(?P<netsh_wlan>netsh.*wlan)
(?P<netsh>netsh)
(?P<nltest_server>nltest.*\/server)
(?P<nltest_user>nltest.*\/user)
(?P<nltest>nltest)
(?P<NTLMHASH>NTLMHASH)
(?P<odbconf_regsvr>odbcconf[\s\w]+.*regsvr)
(?P<powerpoint_http>owerpnt.*http)
(?P<powershell_add_acl>owershell.*Add\-ObjectACL)
(?P<powershell_AppLockerPolicy>AppLockerPolicy)
(?P<powershell_assembly_get_type>Assembly\.GetType)
(?P<powershell_backdoor>owershell.*ackdoor)
(?P<powershell_call>powershell)
(?P<powershell_ConPtyShell>ConPtyShell)
(?P<powershell_convert_to_base64>onvert.*64.*tring)
(?P<powershell_CreateInstance_eshell>CreateInstance.*ExecuteShellCommand)
(?P<powershell_CreateInstance_MMC20>CreateInstance.*MMC20)
(?P<powershell_CreateInstance>CreateInstance)
(?P<powershell_domain_trust>Get\-DomainTrust)
(?P<powershell_domaingpo>Get\-DomainGPO)
(?P<powershell_DomainGPOLocalGroup>DomainGPOLocalGroup)
(?P<powershell_DomainObjectAcl>DomainObjectAcl)
(?P<powershell_encoding_get_bytes>ystem.*ncoding.*ytes)
(?P<powershell_enter_ps_session_creds>nter\-.*s.*ession.*dential)
(?P<powershell_Find_DomainShare>Find\-DomainShare)
(?P<powershell_Find_DomainUserLocation>ind\-DomainUserLocation)
(?P<powershell_Find_LocalAdminAccess>ind\-LocalAdminAccess)
(?P<powershell_forest_trust>Get\-ForestTrust)
(?P<powershell_get_domain_info>Get\-Domain)
(?P<powershell_Get_DomainComputer>Get\-DomainComputer)
(?P<powershell_Get_DomainGroup>Get\-DomainGroup)
(?P<powershell_Get_DomainOU>Get\-DomainOU)
(?P<powershell_Get_DomainUser>Get\-DomainUser)
(?P<powershell_http_client>Object.*Net.*Http)
(?P<powershell_http_requests_get>in.*ttp.*equest.*GET)
(?P<powershell_http_requests_open>in.*ttp.*equest.*open)
(?P<powershell_http_requests_post>in.*ttp.*equest.*POST)
(?P<powershell_InterestingDomainAcl>InterestingDomainAcl)
(?P<powershell_invoke_command_credentials>nvoke.*ommand.*redential)
(?P<powershell_invoke_execution_lc>iex)
(?P<powershell_invoke_execution>IEX)
(?P<powershell_invoke_web_request_output_file>nvoke.*equest.*ut.*ile)
(?P<powershell_invoke_web_request_sm_up>IWR.*http)
(?P<powershell_invoke_web_request_sm>iwr.*http)
(?P<powershell_invoke_web_request>Invoke\-WebRequest.*http)
(?P<powershell_invoke_wmimethod>nvoke.*mi.*ethod)
(?P<powershell_net_client_credentials>Object.*Net.*WebClient.*Credentials)
(?P<powershell_net_client>Object.*Net.*WebClient)
(?P<powershell_new_ps_session_creds>ew\-.*s.*ession.*dential)
(?P<powershell_select>owershell.*select)
(?P<powershell_sherlock>powershell.*herlock)
(?P<powershell_spn>\-SPN)
(?P<powershell_sql_query>powershell.*SQL.*uery)
(?P<powershell_system_credentials>bject.*ystem.*edential)
(?P<powershell_tcp_socket>New-Object.*Sockets.*TCPClient)
(?P<powershell_token_create_process>nvoke.*oken.*pulation.*reate.*rocess)
(?P<powershell_token_impersonate>nvoke.*oken.*pulation.*mpersonate)
(?P<powershell_token_manipulation>nvoke.*oken.*pulation)
(?P<powershell_web_client_download>ystem.*eb.*lient.*ownload)
(?P<powershell_wmi_execute_encoded>nvoke.*mi.*ethod.*\-e)
(?P<powershell_write_bytes>io\.file.*WriteAllBytes)
(?P<powershelll_execute_script>powershell.*\-c)
(?P<procdump_process>rocdump.*\-[\-\s\w]+)
(?P<ps_file>\.ps1)
(?P<psexec_password>psexec.*\-p)
(?P<psexec_user>psexec.*\-u)
(?P<pubprn_http>pubprn.*http)
(?P<pubprn_script>pubprn.*script)
(?P<python_connect>python.*connect)
(?P<python_execute_string>ython.*\-c)
(?P<python_subprocess>ython.*subprocess)
(?P<python_tgsrepcrack>ython.*tgsrepcrack)
(?P<qwinsta_server>qwinsta.*\/server)
(?P<qwinsta>qwinsta)
(?P<reg_query>reg\s.*query)
(?P<reg_save_hklm>reg.*save.*hklm)
(?P<regasm_download>regasm.*[\s\w\/]+)
(?P<regsvr32_dowload>regsvr32[\s\w\/]+.*http)
(?P<rogue_potatp>ogue.*otato.*\-r)
(?P<rubeus_aes>ubeus.*aes)
(?P<rubeus_asktgt>ubeus.*asktgt)
(?P<rubeus_credpassword>ubeus.*credpassword)
(?P<rubeus_creduser>ubeus.*creduser)
(?P<rubeus_domain>ubeus.*domain)
(?P<rubeus_kerberoast>ubeus.*kerberoast)
(?P<rubeus_rc4>ubeus.*rc4)
(?P<ruby_execute>ruby.*\-e\s)
(?P<ruby_open>ruby.*popen)
(?P<ruby_rsocket>ruby.*\-rsocket)
(?P<runas_user>runas\s.*\/user)
(?P<runas>runas\s)
(?P<rundll_open>rundll.*penURL)
(?P<rundll32_js_http_exec>rundll32.*javascript.*http)
(?P<sc_remote>sc.*\\\\)
(?P<sc_start_remote>sc.*\\\\.*start)
(?P<sc_start>sc.*start)
(?P<schtasks_create>schtasks.*\/create)
(?P<schtasks_once>schtasks.*once)
(?P<schtasks_run>schtasks.*\/run)
(?P<schtasks_s>schtasks.*\/s)
(?P<schtasks_schedule>schtasks.*\/sc)
(?P<sdelete_q>sdelete.*\-q)
(?P<sdelete>sdelete)
(?P<SharpGPOAbuse_command>harp.*buse.*ommand)
(?P<sharpHound_invoke>harp.*ound)
(?P<sharphound_password>harp.*ound.*assword)
(?P<sharphound_username>harp.*ound.*sername)
(?P<squirrel_download>squirrel.*download)
(?P<squirrel_http>squirrel.*http)
(?P<squirrel_update>squirrel.*update)
(?P<systeminfo_S>systeminfo.*\/S)
(?P<systeminfo>systeminfo)
(?P<tasklist_fi>tasklist.*\/fi)
(?P<tasklist_password>tasklist.*\/p)
(?P<tasklist_status>tasklist.*STATUS)
(?P<tasklist_svcup_flag>tasklist.*\s\/[svcup]+)
(?P<tasklist_u>tasklist.*\/u)
(?P<tasklist>tasklist)
(?P<tftp_I>tftp.*\-I)
(?P<tftp>tftp)
(?P<tgsrepcrack>tgsrepcrack)
(?P<tree_A>tree\s.*\/A)
(?P<tree_F>tree\s.*\/F)
(?P<Update_download>pdate.*download)
(?P<Update_http>Update.*http)
(?P<Update_update>pdate.*update)
(?P<vbs_file>\.vbs)
(?P<vssadmin_list>vssadmin.*list)
(?P<wce_l>wce.*\-l)
(?P<wce_v>wce.*\-v)
(?P<wce>wce\s)
(?P<webclientDownload_http>call.*webclientDownload.*http)
(?P<wevtutil>wevtutil)
(?P<wevutil_clear>wevtutil.*clear)
(?P<winhhtpjs_http>call.*winhhtpjs.*http)
(?P<winrm_http>winrm.*http)
(?P<winrs_password>winrs.*\-p)
(?P<winrs_remote>winrs.*\-r)
(?P<winrs_user>winrs.*\-u)
(?P<winword_http>winword.*http)
(?P<wmic_call>wmic.*call)
(?P<wmic_create>wmic.*create)
(?P<wmic_download>wmic.*os.*get.*http)
(?P<wmic_list>wmic.*list)
(?P<wmic_node>wmic.*node)
(?P<wmic_password>wmic.*password)
(?P<wmic_process>wmic.*process)
(?P<wmic_shadowcopy>wmic.*shadowcopy)
(?P<wmic_user>wmic.*user)
(?P<wsl_dev_tcp>wsl.*dev.*tcp)
(?P<wsl_e>wsl.*\-e)
(?P<wsl_exec>wsl.*exec)
(?P<wusa_kb>wusa.*kb)
(?P<wusa_norestart>wusa.*\/norestart)
(?P<wusa_quiet>wusa.*\/quiet)
(?P<wusa_uninstall>wusa.*\/uninstall)
(?P<XMLHTTPDownloadJS_http>call.*XMLHTTPDownloadJS.*http)
